# デバッグチェックリスト

## 現在の状況

コンソールにデバッグログ（`🔍 クライアント側リダイレクトスクリプト開始`など）が表示されていません。
これは、`app/root.tsx`のスクリプトが実行されていない、またはページ自体が読み込まれていない可能性を示しています。

## 確認すべき項目

### 1. サーバー側のログを確認（最重要）

ターミナルで`shopify app dev`を実行しているウィンドウを確認してください。

以下のログが表示されているか確認：
- `🔍 entry.server.tsx リクエスト受信`
- `🔍 root.tsx loader実行`
- `🔄 サーバー側リダイレクト実行` または `✅ サーバー側リダイレクト不要`

**もしこれらのログが表示されていない場合：**
- リクエストがサーバーに到達していない
- 古いURLでCloudflare Tunnelレベルで接続拒否されている可能性が高い

### 2. ブラウザのNetworkタブを確認

1. ブラウザの開発者ツール（F12）を開く
2. **Networkタブ**をクリック
3. ページをリロード（F5）
4. 以下を確認：

**確認ポイント：**
- リクエストが送信されているか
- ステータスコードは何か（200, 302, 404, 503など）
- どのURLにリクエストが送信されているか（古いURLか最新URLか）

**特に確認すべきリクエスト：**
- メインのHTMLドキュメント（通常は最初のリクエスト）
- そのリクエストのURLが古いURL（`forest-cafe-spice-magnificent.trycloudflare.com`）か最新URL（`verified-mailto-scoop-filled.trycloudflare.com`）か

### 3. ページのHTMLソースを確認

1. ブラウザの開発者ツール（F12）を開く
2. **Elementsタブ**をクリック
3. `<head>`タグ内を確認
4. 以下のスクリプトが含まれているか確認：

```html
<script>
  (function() {
    console.log("🔍 クライアント側リダイレクトスクリプト開始");
    // ... 以下略
  })();
</script>
```

**もしこのスクリプトが含まれていない場合：**
- `app/root.tsx`が正しくレンダリングされていない
- 別のルート（エラーページなど）が表示されている可能性

### 4. アプリが実際に表示されているか確認

ブラウザの画面で以下を確認：
- アプリのページが表示されているか（「Free Plan」バッジと「Upgrade to PRO」ボタン）
- エラーページが表示されているか
- 空白のページが表示されているか
- 「接続が拒否されました」などのエラーメッセージが表示されているか

### 5. 現在のURLを確認

ブラウザのアドレスバーで、実際にアクセスしているURLを確認：
- 古いURL（`forest-cafe-spice-magnificent.trycloudflare.com`）か
- 最新URL（`verified-mailto-scoop-filled.trycloudflare.com`）か

## 予想される原因と解決策

### 原因1: 古いURLでCloudflare Tunnelレベルで接続拒否

**症状：**
- サーバー側のログが表示されない
- Networkタブでリクエストが失敗している
- ブラウザに「接続が拒否されました」と表示される

**解決策：**
- Shopify Adminが古いURLを返している
- アプリを再インストールする必要がある

### 原因2: ページが読み込まれていない

**症状：**
- Networkタブでリクエストは送信されているが、HTMLが返ってこない
- サーバー側のログは表示されているが、クライアント側のログが表示されない

**解決策：**
- サーバー側のログを確認して、エラーが発生していないか確認

### 原因3: 別のルートが表示されている

**症状：**
- HTMLソースにリダイレクトスクリプトが含まれていない
- エラーページが表示されている

**解決策：**
- `app/routes/app.tsx`の`ErrorBoundary`が表示されている可能性
- サーバー側のログでエラーを確認

## 次のステップ

1. **まず、サーバー側のログを確認してください**（ターミナル）
2. **次に、Networkタブを確認してください**（ブラウザ）
3. **最後に、ElementsタブでHTMLソースを確認してください**（ブラウザ）

これらの情報を共有していただければ、より具体的な解決策を提案できます。


