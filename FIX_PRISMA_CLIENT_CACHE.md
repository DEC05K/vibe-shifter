# Prisma Clientã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å•é¡Œã‚’ä¿®æ­£

## ã‚¨ãƒ©ãƒ¼å†…å®¹

```
Prisma session table does not exist
```

ç’°å¢ƒå¤‰æ•°ã®è¨­å®šã¯å•é¡Œãªã„ãŒã€ã‚¨ãƒ©ãƒ¼ãŒæ¶ˆãˆãªã„ã€‚

## æ ¹æœ¬åŸå› 

**Vercelã®ãƒ“ãƒ«ãƒ‰æ™‚ã«Prisma ClientãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã¦ã„ãªã„ã€ã¾ãŸã¯å¤ã„ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹**å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

è€ƒãˆã‚‰ã‚Œã‚‹åŸå› ï¼š
1. Prisma ClientãŒãƒ“ãƒ«ãƒ‰æ™‚ã«æ­£ã—ãç”Ÿæˆã•ã‚Œã¦ã„ãªã„
2. Vercelã®ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå¤ã„Prisma Clientã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹
3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã¯æˆåŠŸã—ã¦ã„ã‚‹ãŒã€Prisma ClientãŒãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œãªã„

## è§£æ±ºæ–¹æ³•

### æ–¹æ³•1: Vercelã®ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦å†ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ¨å¥¨ï¼‰

1. **Vercelãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹**
   - https://vercel.com ã«ãƒ­ã‚°ã‚¤ãƒ³
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ `delivery-gift-lite` ã‚’é¸æŠ

2. **å†ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ï¼‰**
   - ã€ŒDeploymentsã€ã‚¿ãƒ–ã‚’é–‹ã
   - æœ€æ–°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã®ã€Œ...ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒRedeployã€ã‚’é¸æŠ
   - **ã€ŒUse existing Build Cacheã€ã®ãƒã‚§ãƒƒã‚¯ã‚’å¤–ã™**ï¼ˆé‡è¦ï¼‰
   - ã€ŒRedeployã€ã‚’ã‚¯ãƒªãƒƒã‚¯

ã“ã‚Œã«ã‚ˆã‚Šã€Prisma ClientãŒæ–°ã—ãç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### æ–¹æ³•2: package.jsonã®buildã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç¢ºèª

`package.json`ã®`build`ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«`prisma generate`ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

ç¾åœ¨ã®è¨­å®šï¼š
```json
"build": "prisma generate && remix vite:build"
```

ã“ã®è¨­å®šã«ã‚ˆã‚Šã€ãƒ“ãƒ«ãƒ‰æ™‚ã«Prisma ClientãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### æ–¹æ³•3: postinstallã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç¢ºèª

`package.json`ã®`postinstall`ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«`prisma generate`ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

ç¾åœ¨ã®è¨­å®šï¼š
```json
"postinstall": "prisma generate"
```

ã“ã®è¨­å®šã«ã‚ˆã‚Šã€`npm install`ã®å¾Œã«Prisma ClientãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### æ–¹æ³•4: Vercelã®ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã‚’ç¢ºèª

1. **Vercelãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹**
   - https://vercel.com ã«ãƒ­ã‚°ã‚¤ãƒ³
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ `delivery-gift-lite` ã‚’é¸æŠ

2. **ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã‚’ç¢ºèª**
   - ã€ŒDeploymentsã€ã‚¿ãƒ–ã§æœ€æ–°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’é¸æŠ
   - ã€ŒBuild Logsã€ã‚’é–‹ã
   - ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªï¼š
     - `âœ” Generated Prisma Client`
     - `Running "install" command`
     - `Running "build" command`

3. **ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹ç¢ºèª**
   - Prisma Clientã®ç”Ÿæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ãªã„ã‹ç¢ºèª
   - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ãªã„ã‹ç¢ºèª

### æ–¹æ³•5: ãƒ­ãƒ¼ã‚«ãƒ«ã§Prisma Clientã‚’å†ç”Ÿæˆã—ã¦ãƒ—ãƒƒã‚·ãƒ¥

1. **ãƒ­ãƒ¼ã‚«ãƒ«ã§Prisma Clientã‚’å†ç”Ÿæˆ**

```bash
cd /Users/hakkow_h/delivery-gift-lite
export DATABASE_URL="postgresql://postgres:Blessinghamlet_315%2B@db.jhgszqygorqgqmovijzh.supabase.co:5432/postgres"
npx prisma generate
```

2. **å¤‰æ›´ã‚’GitHubã«ãƒ—ãƒƒã‚·ãƒ¥**

```bash
git add .
git commit -m "Regenerate Prisma Client"
git push origin main
```

3. **Vercelã§è‡ªå‹•å†ãƒ‡ãƒ—ãƒ­ã‚¤**
   - GitHubã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã¨ã€VercelãŒè‡ªå‹•çš„ã«å†ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’é–‹å§‹ã—ã¾ã™

### æ–¹æ³•6: Prismaã®ã‚¹ã‚­ãƒ¼ãƒã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’åŒæœŸ

1. **ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®çŠ¶æ…‹ã‚’ç¢ºèª**

```bash
cd /Users/hakkow_h/delivery-gift-lite
export DATABASE_URL="postgresql://postgres:Blessinghamlet_315%2B@db.jhgszqygorqgqmovijzh.supabase.co:5432/postgres"
npx prisma db pull
```

2. **Prisma Clientã‚’å†ç”Ÿæˆ**

```bash
npx prisma generate
```

3. **å¤‰æ›´ã‚’GitHubã«ãƒ—ãƒƒã‚·ãƒ¥**

```bash
git add .
git commit -m "Sync Prisma schema with database"
git push origin main
```

## ç¢ºèªæ–¹æ³•

### æ–¹æ³•1: Vercelã®ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã§ç¢ºèª

1. **ã€ŒDeploymentsã€ã‚¿ãƒ–ã§æœ€æ–°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’é¸æŠ**
2. **ã€ŒBuild Logsã€ã‚’é–‹ã**
3. **ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª**:
   - `Running "postinstall" command`
   - `âœ” Generated Prisma Client`
   - `Running "build" command`
   - `âœ” Generated Prisma Client`ï¼ˆbuildã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ï¼‰

### æ–¹æ³•2: Runtime Logsã§ç¢ºèª

1. **ã€ŒDeploymentsã€ã‚¿ãƒ–ã§æœ€æ–°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’é¸æŠ**
2. **ã€ŒRuntime Logsã€ã‚’é–‹ã**
3. **ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ãªã„ã‹ç¢ºèª**:
   - `Prisma session table does not exist`
   - `Can't reach database server`

## ã‚ˆãã‚ã‚‹é–“é•ã„

### é–“é•ã„1: ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã—ã¦å†ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã„ã‚‹

ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€å¤ã„Prisma ClientãŒä½¿ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

**è§£æ±ºæ–¹æ³•**: å†ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«ã€ŒUse existing Build Cacheã€ã®ãƒã‚§ãƒƒã‚¯ã‚’å¤–ã—ã¦ãã ã•ã„ã€‚

### é–“é•ã„2: Prisma ClientãŒç”Ÿæˆã•ã‚Œã¦ã„ãªã„

`package.json`ã®`build`ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«`prisma generate`ãŒå«ã¾ã‚Œã¦ã„ãªã„å ´åˆã€Prisma ClientãŒç”Ÿæˆã•ã‚Œã¾ã›ã‚“ã€‚

**è§£æ±ºæ–¹æ³•**: `package.json`ã®`build`ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## ã¾ã¨ã‚

1. âœ… **Vercelã®ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦å†ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ–¹æ³•1 - æ¨å¥¨ï¼‰**
2. ğŸ“‹ **package.jsonã®buildã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç¢ºèªï¼ˆæ–¹æ³•2ï¼‰**
3. ğŸ“‹ **Vercelã®ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã‚’ç¢ºèªï¼ˆæ–¹æ³•4ï¼‰**
4. ğŸ“‹ **ãƒ­ãƒ¼ã‚«ãƒ«ã§Prisma Clientã‚’å†ç”Ÿæˆã—ã¦ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆæ–¹æ³•5ï¼‰**
5. ğŸ“‹ **Prismaã®ã‚¹ã‚­ãƒ¼ãƒã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’åŒæœŸï¼ˆæ–¹æ³•6ï¼‰**

**æœ€ã‚‚é‡è¦ãªã®ã¯ã€ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã¦å†ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã“ã¨ã§ã™ã€‚**

