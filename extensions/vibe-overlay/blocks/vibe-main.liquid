{% comment %}
  Vibe Shifter AI - V10 (MONETIZATION READY)
  ã€Œãƒ¡ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€ã‚’èª­ã¿å–ã£ã¦ã€ç„¡æ–™ä¼šå“¡ã«ã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ç´ æã‚’ä½¿ã‚ã›ãªã„
  ã€Œãƒ­ãƒƒã‚¯æ©Ÿèƒ½ã€ã‚’æ­è¼‰ã—ãŸåç›ŠåŒ–å¯¾å¿œç‰ˆã€‚
{% endcomment %}

{% assign user_plan = shop.metafields.vibeshifter.plan %}
{% assign is_premium = false %}
{% if user_plan == 'premium' %}
  {% assign is_premium = true %}
{% endif %}

{% assign selected_mode = block.settings.texture_mode %}
{% assign opacity_val = block.settings.vibe_opacity | divided_by: 100.0 %}
{% assign pattern_size = block.settings.pattern_size %}
{% assign layer_mode = block.settings.layer_mode %}
{% assign force_transparent = block.settings.force_transparent %}
{% assign transparent_all = block.settings.transparent_all %}

{% if is_premium == false %}
  {% if selected_mode == 'preset_2' or selected_mode == 'preset_3' or selected_mode == 'preset_4' %}
    {% assign selected_mode = 'preset_1' %}
    <script>console.log("Vibe Shifter: Free plan detected. Premium assets are locked.");</script>
  {% endif %}
{% endif %}


{% if selected_mode == 'preset_1' %}
  {% assign bg_image_url = 'preset-1.png' | asset_url %}
{% elsif selected_mode == 'preset_2' %}
  {% assign bg_image_url = 'preset-2.jpg' | asset_url %}
{% elsif selected_mode == 'preset_3' %}
  {% assign bg_image_url = 'preset-3.png' | asset_url %}
{% elsif selected_mode == 'preset_4' %}
  {% assign bg_image_url = 'preset-4.png' | asset_url %}
{% else %}
  {% assign bg_image_url = block.settings.custom_image | image_url: width: 2000 %}
{% endif %}

<div class="vibe-overlay-v10">&nbsp;</div>

<style>
  .vibe-overlay-v10 {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    display: block !important;
    
    background-image: url("{{ bg_image_url }}");
    background-repeat: repeat;
    background-size: {{ pattern_size }}px auto;
    background-position: top left;
    
    opacity: {{ opacity_val }};
    mix-blend-mode: {{ block.settings.vibe_blend }};
    z-index: {{ layer_mode }};
  }

  {% if force_transparent %}
    body {
      background: transparent !important;
      background-color: transparent !important;
    }

    {% if transparent_all %}
      .gradient, .color-background-1, .color-scheme-1 {
        background: transparent !important;
        background-color: transparent !important;
      }
    {% else %}
      .gradient:not(.announcement-bar):not(.header-wrapper):not(header):not(.footer):not(.shopify-section-group-header-group):not(.shopify-section-group-footer-group),
      .color-background-1:not(.announcement-bar):not(.header-wrapper):not(header):not(.footer):not(.shopify-section-group-header-group):not(.shopify-section-group-footer-group),
      .color-scheme-1:not(.announcement-bar):not(.header-wrapper):not(header):not(.footer):not(.shopify-section-group-header-group):not(.shopify-section-group-footer-group) {
        background: transparent !important;
        background-color: transparent !important;
      }
    {% endif %}
    
    .page-container, .main-content {
       background: transparent !important;
    }
  {% endif %}
</style>

{% schema %}
{
  "name": "Vibe Shifter v10",
  "target": "body",
  "settings": [
    {
      "type": "header",
      "content": "1. ç´ æã‚’é¸ã¶ (Material)"
    },
    {
      "type": "paragraph",
      "content": "âš ï¸ No.2ã€œ4 ã¯PROãƒ—ãƒ©ãƒ³å°‚ç”¨ã§ã™ã€‚ç„¡æ–™ãƒ—ãƒ©ãƒ³ã§ã¯é¸æŠã—ã¦ã‚‚No.1ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚"
    },
    {
      "type": "select",
      "id": "texture_mode",
      "label": "ãƒ†ã‚¯ã‚¹ãƒãƒ£ã®ç¨®é¡",
      "options": [
        { "value": "preset_1", "label": "No.1: ãƒã‚¤ã‚º (Free)" },
        { "value": "preset_2", "label": "ğŸ”’ No.2: å’Œç´™ (Pro Only)" },
        { "value": "preset_3", "label": "ğŸ”’ No.3: æ¡œ (Pro Only)" },
        { "value": "preset_4", "label": "ğŸ”’ No.4: ãƒ›ãƒ­ã‚°ãƒ©ãƒ  (Pro Only)" },
        { "value": "custom", "label": "ğŸ“ ã‚«ã‚¹ã‚¿ãƒ ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰" }
      ],
      "default": "preset_1"
    },
    /* ä»¥ä¸‹ã€è¨­å®šé …ç›®ã¯v9ã¨åŒã˜ãªã®ã§çœç•¥ã›ãšãã®ã¾ã¾è¨˜è¿° */
    {
      "type": "image_picker",
      "id": "custom_image",
      "label": "ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",
      "info": "â€»ä¸Šã§ã€Œã‚«ã‚¹ã‚¿ãƒ ç”»åƒã€ã‚’é¸ã‚“ã å ´åˆã®ã¿æœ‰åŠ¹"
    },
    {
      "type": "header",
      "content": "2. è¦‹ãŸç›®ã‚’èª¿æ•´ (Appearance)"
    },
    {
      "type": "range",
      "id": "vibe_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®æ¿ƒã•",
      "default": 50
    },
    {
      "type": "range",
      "id": "pattern_size",
      "min": 50,
      "max": 1000,
      "step": 10,
      "unit": "px",
      "label": "æŸ„ã®ã‚µã‚¤ã‚º (æ‹¡å¤§ãƒ»ç¸®å°)",
      "default": 300
    },
    {
      "type": "select",
      "id": "vibe_blend",
      "label": "åˆæˆãƒ¢ãƒ¼ãƒ‰ (é›°å›²æ°—)",
      "options": [
        { "value": "multiply", "label": "ä¹—ç®— (æš—ãé¦´æŸ“ã‚€ï¼šå’Œç´™ãƒ»æ±šã‚Œ)" },
        { "value": "screen", "label": "ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ (æ˜ã‚‹ãå…‰ã‚‹ï¼šãƒã‚ªãƒ³)" },
        { "value": "overlay", "label": "ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ (ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆå¼·èª¿)" },
        { "value": "normal", "label": "é€šå¸¸ (ãã®ã¾ã¾è¡¨ç¤º)" }
      ],
      "default": "multiply"
    },
    {
      "type": "header",
      "content": "3. é…ç½®ã¨é€é (Layout)"
    },
    {
      "type": "select",
      "id": "layer_mode",
      "label": "è¡¨ç¤ºã™ã‚‹å ´æ‰€",
      "options": [
        { "value": "-1", "label": "ã€æ¨å¥¨ã€‘èƒŒæ™¯ã®è£å´ (æ–‡å­—ãƒ»ç”»åƒã®ä¸‹)" },
        { "value": "10", "label": "æ¨™æº– (ç”»åƒã®ä¸Šãƒ»ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ä¸‹)" },
        { "value": "2147483647", "label": "æœ€å‰é¢ (ã™ã¹ã¦ã®ä¸Š)" }
      ],
      "default": "-1"
    },
    {
      "type": "checkbox",
      "id": "force_transparent",
      "label": "ãƒ†ãƒ¼ãƒã®èƒŒæ™¯è‰²ã‚’é€æ˜åŒ–ã™ã‚‹",
      "default": true,
      "info": "â€»é‡è¦ï¼šã€ŒèƒŒæ™¯ã®è£å´ã€ã«è¡¨ç¤ºã™ã‚‹å ´åˆã¯ONã«ã—ã¦ãã ã•ã„ã€‚"
    },
    {
      "type": "checkbox",
      "id": "transparent_all",
      "label": "ãƒ˜ãƒƒãƒ€ãƒ¼ã‚„ãƒ•ãƒƒã‚¿ãƒ¼ã‚‚é€æ˜åŒ–ã™ã‚‹",
      "default": false,
      "info": "ONã«ã™ã‚‹ã¨ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚„ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ãƒãƒ¼ã®èƒŒæ™¯è‰²ã‚‚æ¶ˆãˆã¾ã™ã€‚"
    }
  ]
}
{% endschema %}