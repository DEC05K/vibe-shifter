# ngrok vs Cloudflare Tunnel 比較ガイド

## ngrokとは？

**ngrok**は、ローカル開発環境をインターネット経由でアクセス可能にするトンネルサービスです。主に開発者がローカルサーバーを外部に公開するために使用します。

### 基本的な仕組み

1. ローカルサーバー（例: `localhost:3000`）を起動
2. ngrokを起動してトンネルを作成
3. ngrokがランダムなURL（例: `https://abc123.ngrok-free.app`）を生成
4. そのURLにアクセスすると、ローカルサーバーに接続される

## ngrokの特徴

### 無料プラン（Free）

- ✅ **固定URLが利用可能**（制限あり）
- ✅ **HTTPS対応**
- ✅ **簡単なセットアップ**
- ✅ **リアルタイムのリクエスト監視**
- ⚠️ **接続数の制限**（同時接続数に制限）
- ⚠️ **帯域幅の制限**
- ⚠️ **固定URLはランダム**（カスタムドメインは有料）

### 有料プラン（$8/月〜）

- ✅ **カスタムドメイン**
- ✅ **より多くの接続数**
- ✅ **より多くの帯域幅**
- ✅ **専用IPアドレス**

## Cloudflare Tunnelとの比較

### ngrokを選択した場合

#### メリット

1. **セットアップが簡単**
   - インストールと設定が数分で完了
   - コマンド1つで起動可能

2. **固定URLが無料で利用可能**
   - 無料プランでも固定URLが使える
   - 再起動してもURLが変わらない（固定ドメインを使用する場合）

3. **リクエスト監視機能**
   - Web UIでリクエストをリアルタイムで確認できる
   - デバッグに便利

4. **ドキュメントが充実**
   - 公式ドキュメントが分かりやすい
   - コミュニティサポートが豊富

5. **Shopify開発に適している**
   - Shopify CLIと相性が良い
   - 多くのShopify開発者が使用している

#### デメリット

1. **無料プランには制限がある**
   - 同時接続数に制限
   - 帯域幅に制限
   - 固定URLはランダム（カスタムドメインは有料）

2. **サービス依存**
   - ngrokのサービスが停止すると使用できない
   - 外部サービスに依存

3. **セキュリティ**
   - 無料プランでは、ngrokの警告ページが表示される場合がある
   - 有料プランで回避可能

### Cloudflare Tunnelを選択した場合

#### メリット

1. **完全無料**
   - すべての機能が無料で利用可能
   - 制限が少ない

2. **独自ドメインが無料で利用可能**
   - 無料ドメイン（Freenomなど）と組み合わせれば完全無料
   - カスタムドメインも無料で使用可能

3. **高速**
   - CloudflareのCDNを使用
   - 世界中に分散されたサーバー

4. **安定性**
   - Cloudflareのインフラを使用
   - 高い可用性

#### デメリット

1. **セットアップが複雑**
   - 独自ドメインの取得と設定が必要
   - Cloudflareの設定が少し複雑

2. **初期設定に時間がかかる**
   - ドメイン取得から設定まで30分〜1時間程度

3. **無料プランでは固定URLが難しい**
   - 独自ドメインを使用しない場合、URLが変わる
   - 独自ドメインの設定が必要

## 推奨される選択

### 開発環境の場合

**ngrokを推奨**します。

**理由**:
- セットアップが簡単（5分程度）
- 固定URLが無料で利用可能
- Shopify開発に適している
- リクエスト監視機能が便利

### 本番環境の場合

**Cloudflare Tunnel + 独自ドメイン**を推奨します。

**理由**:
- 完全無料
- より安定している
- カスタムドメインが無料で使用可能

## ngrokのセットアップ手順（簡単版）

### ステップ1: ngrokアカウントを作成

1. https://ngrok.com にアクセス
2. 「Sign up」をクリック
3. アカウントを作成（無料）

### ステップ2: ngrokをインストール

```bash
# macOS
brew install ngrok

# または、公式サイトからダウンロード
# https://ngrok.com/download
```

### ステップ3: 認証トークンを設定

1. ngrokダッシュボードにログイン
2. 「Your Authtoken」をコピー
3. ターミナルで実行:

```bash
ngrok config add-authtoken YOUR_AUTH_TOKEN
```

### ステップ4: 固定URLで起動

```bash
# 固定URLで起動（無料プランでも可能）
ngrok http 3000 --domain=your-fixed-domain.ngrok-free.app
```

**注意**: 無料プランでは、固定URLはランダムに割り当てられます。カスタムドメインを使用する場合は有料プランが必要です。

### ステップ5: shopify.app.tomlを更新

```toml
application_url = "https://your-fixed-domain.ngrok-free.app"
```

### ステップ6: .envファイルを更新

```bash
SHOPIFY_APP_URL=https://your-fixed-domain.ngrok-free.app
```

## まとめ

| 項目 | ngrok | Cloudflare Tunnel |
|------|-------|-------------------|
| セットアップの簡単さ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 無料で固定URL | ✅（ランダム） | ✅（独自ドメイン必要） |
| カスタムドメイン | ❌（有料） | ✅（無料） |
| リクエスト監視 | ✅ | ❌ |
| 安定性 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| Shopify開発への適性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |

**開発環境ではngrokを推奨**します。セットアップが簡単で、すぐに使い始められます。

